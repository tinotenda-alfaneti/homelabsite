{{define "post.html"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }}</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="/static/js/theme.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="/" class="logo">Atarnet Homelab</a>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="/services">Services</a></li>
                    <li><a href="/blog">Blog</a></li>
                    <li><a href="/about">About</a></li>
                    <li><button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">üåô</button></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        {{if .Breadcrumbs}}
        <nav class="breadcrumbs" aria-label="breadcrumb">
            {{range $index, $crumb := .Breadcrumbs}}
                {{if $crumb.URL}}
                    <a href="{{$crumb.URL}}">{{$crumb.Name}}</a>
                {{else}}
                    <span>{{$crumb.Name}}</span>
                {{end}}
                {{if ne (add $index 1) (len $.Breadcrumbs)}}
                    <span class="separator">/</span>
                {{end}}
            {{end}}
        </nav>
        {{end}}

<article class="post-full">
    <header class="post-header">
        <div class="post-meta">
            <span class="post-category">{{ .Post.Category }}</span>
            <span class="post-date">{{ .Post.Date.Format "January 2, 2006" }}</span>
            {{ if .Post.Views }}<span class="post-views">{{ .Post.Views }} views</span>{{ end }}
        </div>
        <h1>{{ .Post.Title }}</h1>
        {{ if .Post.Tags }}
        <div class="post-tags">
            {{ range .Post.Tags }}
            <span class="tag">{{ . }}</span>
            {{ end }}
        </div>
        {{ end }}
    </header>

    <div class="post-content">
        {{ markdown .Post.Content }}
    </div>

    <!-- Comments Section -->
    <section class="comments-section" id="comments">
        <h2>Comments</h2>
        
        <div id="comments-container" 
             hx-get="/api/posts/{{ .Post.ID }}/comments"
             hx-trigger="load"
             hx-swap="innerHTML">
            <p class="loading">Loading comments...</p>
        </div>

        <div class="comment-form">
            <h3>Leave a Comment</h3>
            <form hx-post="/api/posts/{{ .Post.ID }}/comments"
                  hx-target="#comment-status"
                  hx-swap="innerHTML"
                  class="comment-form-fields">
                <div class="form-group">
                    <label for="author_name">Name</label>
                    <input type="text" id="author_name" name="author_name" required>
                </div>
                <div class="form-group">
                    <label for="author_email">Email</label>
                    <input type="email" id="author_email" name="author_email" required>
                    <small>Not publicly displayed</small>
                </div>
                <div class="form-group">
                    <label for="content">Comment</label>
                    <textarea id="content" name="content" rows="5" maxlength="2000" required></textarea>
                </div>
                <button type="submit" class="btn-primary">Submit Comment</button>
                <div id="comment-status"></div>
            </form>
        </div>
    </section>

    <footer class="post-footer">
        <a href="/blog" class="back-link">‚Üê Back to Blog</a>
    </footer>
</article>
    </main>

    <footer class="footer">
        <div class="container">
            <p>Atarnet Homelab &copy; Copyright 2025</p>
            <div class="footer-links">
                <a href="/">Home</a>
                <a href="/services">Services</a>
                <a href="/blog">Blog</a>
                <a href="/about">About</a>
            </div>
        </div>
    </footer>
</body>
</html>
{{end}}
